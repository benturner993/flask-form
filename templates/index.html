{% extends "base.html" %}

{% block content %}
<div style="width: 100%; height: 80vh; display: flex; justify-content: center; align-items: center;">
    <div style="max-width: 90%; width: 100%;">
        <div style="margin: 0; padding: 0; display: flex; justify-content: space-between;">
            <div style="width: 70vw;"> <!-- Form container -->
                <form id="user-form" style="margin-top: 10px; margin-bottom: 10px; display: grid; grid-template-columns: repeat(2, 45%); gap: 5%; position: relative;">
                    <input type="text" id="registration-number" name="registration-number" placeholder="Registration Number" class="input-field">
                    <input type="date" id="renewal-date" name="renewal-date" placeholder="Renewal Date" class="input-field">
                    <input type="number" id="annual-subs" name="annual-subs" placeholder="Total Annual Subs inl IPT" class="input-field">
                    <select id="color-segment" name="color-segment" class="input-field">
                        <option value="Red">Red</option>
                        <option value="Green">Green</option>
                        <option value="Amber">Amber</option>
                        <option value="New">New</option>
                        <option value="Grey">Grey</option>
                        <option value="Blue">Blue</option>
                        <option value="Purple">Purple</option>
                        <option value="Missing">Missing</option>
                    </select>
                    <input type="number" id="claims-paid" name="claims-paid" placeholder="Claims Paid in Last Year" class="input-field">
                    <input type="text" id="payment-frequency" name="payment-frequency" placeholder="Payment Frequency" class="input-field">
                    <input type="number" id="months-arrears" name="months-arrears" placeholder="Months in Arrears" class="input-field">
                    <input type="number" id="months-free-last" name="months-free-last" placeholder="Months Free Last Year" class="input-field">
                    <input type="number" id="months-free-this" name="months-free-this" placeholder="Months Free in This Contract Year" class="input-field">
                    <input type="text" id="offer-accepted" name="offer-accepted" placeholder="Offer Accepted" class="input-field">
                </form>
            </div>
            <div style="background-color: #ccc; padding: 20px; width: 25vw; margin-bottom: 5px;"> <!-- Grey box container -->
                <p>Annual Subs inl IPT:</p>
                <button onclick="displayAnnualSubs()">Display</button>
                <p id="annual-subs-display"></p>
            </div>
        </div>
    </div>
</div>

<button type="button" onclick="submitForm()" style="position: fixed; bottom: 20px; right: 20px;">Submit</button>

<script>
    const formInputs = document.querySelectorAll('.input-field');
    const annualSubsDisplay = document.getElementById('annual-subs-display');

    function submitForm() {
        const formData = {};
        formInputs.forEach(input => {
            formData[input.name] = input.value.trim();
        });

        fetch('/submit', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(formData)
        })
        .then(response => response.json())
        .then(data => {
            alert(data.message);
            formInputs.forEach(input => {
                input.value = '';
            });
        })
        .catch(error => console.error('Error:', error));
    }

    function displayAnnualSubs() {
        const annualSubsInput = document.getElementById('annual-subs').value;

        fetch('/multiply', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ 'annual-subs': annualSubsInput })
        })
        .then(response => response.json())
        .then(data => {
            if (data.result !== undefined) {
                annualSubsDisplay.textContent = data.result;
            } else {
                annualSubsDisplay.textContent = 'Error: ' + data.error;
            }
        })
        .catch(error => console.error('Error:', error));
    }
</script>

<style>
    /* Additional form styling */
    .input-field {
        padding: 10px;
        width: 100%;
    }

    /* Adjust width for select element */
    select.input-field {
        width: calc(100% + 25px); /* Adjust as needed based on appearance */
        padding-right: 30px; /* Increase padding to accommodate dropdown arrow */
    }

    .input-field:not(:last-child) {
        margin-bottom: 10px;
    }

    button {
        padding: 10px 20px;
        background-color: #0d1846;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }
</style>
{% endblock %}
